<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Will You Be My Valentine?</title>
  <style>
    body{
      font-family: "Segoe UI", system-ui, -apple-system, Arial, sans-serif;
      background: linear-gradient(#ffe6f0, #ffffff);
      margin:0;
      padding:20px;
      color:#222;
      display:flex;
      justify-content:center;
    }
    .card{
      width:min(600px, 94vw);
      background: rgba(255,255,255,0.85);
      border: 1px solid rgba(255, 77, 136, 0.18);
      border-radius: 18px;
      padding: 22px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.08);
      position: relative;
      overflow:hidden;
      text-align:center;
    }
    h1{ color:#d63384; margin: 10px 0 6px; font-size: 2.2rem; }
    p{ margin: 8px 0; line-height:1.4; }

    .hero{ width: 260px; margin: 16px auto 8px; display:block; }

    .btnRow{ margin-top: 14px; }
    button{
      padding: 14px 26px;
      margin: 12px 10px;
      font-size: 18px;
      border-radius: 999px;
      border: none;
      cursor:pointer;
      transition: transform 0.12s ease;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
    }
    button:hover{ transform: scale(1.05); }

    .yes{ background:#ff4d88; color:white; }
    .no{ background:#d9d9d9; color:#333; }

    .section{ display:none; margin-top: 10px; }
    .section.active{ display:block; }

    .tag{
      display:inline-block;
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(255,77,136,0.12);
      color:#d63384;
      font-weight: 600;
      margin-top: 6px;
    }

    .inputRow{
      display:flex;
      gap:10px;
      justify-content:center;
      align-items:center;
      flex-wrap:wrap;
      margin-top:12px;
    }
    input[type="text"]{
      font-size: 16px;
      padding: 12px 14px;
      border-radius: 12px;
      border: 1px solid rgba(0,0,0,0.18);
      width: min(360px, 92%);
      outline:none;
    }
    input[type="text"]:focus{
      border-color:#ff4d88;
      box-shadow: 0 0 0 4px rgba(255, 77, 136, 0.15);
    }

    canvas{
      border: 2px solid #ff4d88;
      border-radius: 12px;
      background: white;
      touch-action: none;
      display:block;
      margin: 12px auto 0;
    }

    .smallBtn{
      font-size: 16px;
      padding: 12px 18px;
      margin: 10px 8px 0;
      background: #fff0f6;
      color: #d63384;
      border: 1px solid rgba(214, 51, 132, 0.25);
    }
    .confirmBtn{ background:#ff4d88; color:white; }

    .certificate{
      margin-top: 18px;
      padding: 18px;
      border: 2px dashed rgba(255, 77, 136, 0.5);
      border-radius: 18px;
      background: rgba(255,255,255,0.92);
    }
    .cowImg{
      width: 280px;
      max-width: 90%;
      margin-top: 10px;
    }
    .signature-img{
      width: 320px;
      max-width: 90%;
      border-bottom: 1px solid #111;
      margin-top: 6px;
    }
    .footerLove{ margin-top:10px; font-size: 1.1em; }

    /* Optional tiny error banner */
    .warn{
      display:none;
      margin: 10px auto 0;
      width: min(520px, 94%);
      background: #fff3cd;
      color:#664d03;
      border: 1px solid #ffecb5;
      border-radius: 12px;
      padding: 10px 12px;
      text-align:left;
      font-size: 14px;
    }

    /* "No" button floating inside card */
    .noFloat{
      position:absolute;
      left: 55%;
      top: 78%;
      transform: translate(-50%, -50%);
    }
  </style>
</head>

<body>
  <div class="card" id="card">

    <div class="warn" id="warn">
      If buttons don‚Äôt respond, you may be opening this in a preview that blocks JavaScript.
      Try opening in Safari/Chrome (not email/Drive preview), or host it as a normal link.
    </div>

    <!-- Step 1 -->
    <div id="step1" class="section active">
      <h1>Will you be my Valentine? üíò</h1>

      <!-- Cute generic image (SVG) -->
      <svg class="hero" viewBox="0 0 240 240" xmlns="http://www.w3.org/2000/svg" aria-label="cute hearts">
        <defs>
          <linearGradient id="g" x1="0" y1="0" x2="1" y2="1">
            <stop offset="0" stop-color="#ff4d88"/>
            <stop offset="1" stop-color="#ffa3c4"/>
          </linearGradient>
        </defs>
        <rect x="0" y="0" width="240" height="240" rx="36" fill="rgba(255,255,255,0.7)"/>
        <path d="M120 188c-35-22-70-49-70-84 0-21 15-36 34-36 14 0 27 8 36 20 9-12 22-20 36-20 19 0 34 15 34 36 0 35-35 62-70 84z" fill="url(#g)"/>
        <circle cx="58" cy="64" r="8" fill="#ff4d88" opacity="0.75"/>
        <circle cx="186" cy="62" r="10" fill="#ffa3c4" opacity="0.9"/>
        <circle cx="200" cy="170" r="7" fill="#ff4d88" opacity="0.65"/>
        <circle cx="40" cy="168" r="11" fill="#ffa3c4" opacity="0.8"/>
      </svg>

      <p>One tiny question‚Ä¶ with a tiny surprise after you say yes üòå</p>

      <div class="btnRow">
        <button class="yes" id="yesBtn">Yes ‚ù§Ô∏è</button>
        <button class="no" id="noBtn">No üôà</button>
      </div>
    </div>

    <!-- Step 2 -->
    <div id="step2" class="section">
      <h1>YAY üò≠üíò</h1>
      <p>Before we make it official‚Ä¶ you get to name your surprise Valentine.</p>
      <span class="tag">Pick a cute name ‚ú®</span>

      <div class="inputRow">
        <input id="cowName" type="text" maxlength="24" placeholder="Name (ex: MooMoo, Latte, Biscuit‚Ä¶)" />
      </div>

      <div class="inputRow">
        <button class="smallBtn" id="backBtn">Back</button>
        <button class="confirmBtn" id="continueBtn">Continue ‚Üí</button>
      </div>
    </div>

    <!-- Step 3 -->
    <div id="step3" class="section">
      <h1>One last thing üíå</h1>
      <p>Sign to confirm you accept your Valentine‚Äôs ‚Äútotally serious‚Äù paperwork.</p>

      <canvas id="signaturePad" width="320" height="160"></canvas>

      <div class="inputRow">
        <button class="smallBtn" id="clearBtn">Clear</button>
        <button class="confirmBtn" id="confirmBtn">Confirm</button>
      </div>
    </div>

    <!-- Step 4 -->
    <div id="step4" class="section">
      <div class="certificate">
        <h1>üêÆ ADOPTION CERTIFICATE üêÆ</h1>
        <p>Surprise‚Ä¶ you just adopted a Squishmallow!!</p>

        <p class="tag">Name: <span id="finalCowName">‚Äî</span></p>

        <img class="cowImg" src="cute cow.jpg" alt="Squishmallow cow" />

        <p style="margin-top:14px;"><strong>Adopted by:</strong></p>
        <img id="finalSignature" class="signature-img" alt="Signature" />

        <p id="date"></p>
        <div class="footerLove"><strong>I love you ‚ù§Ô∏è</strong></div>
      </div>
    </div>
  </div>

<script>
(function(){
  const $ = (id) => document.getElementById(id);

  const card = $("card");
  const warn = $("warn");

  const step1 = $("step1");
  const step2 = $("step2");
  const step3 = $("step3");
  const step4 = $("step4");

  const yesBtn = $("yesBtn");
  const noBtn = $("noBtn");
  const backBtn = $("backBtn");
  const continueBtn = $("continueBtn");
  const clearBtn = $("clearBtn");
  const confirmBtn = $("confirmBtn");

  const nameInput = $("cowName");
  const finalCowName = $("finalCowName");
  const finalSignature = $("finalSignature");
  const dateEl = $("date");

  const canvas = $("signaturePad");
  const ctx = canvas.getContext("2d");

  let cowName = "MooMoo";
  let drawing = false;
  let last = null;

  function showStep(stepEl){
    [step1, step2, step3, step4].forEach(s => s.classList.remove("active"));
    stepEl.classList.add("active");
    window.scrollTo({ top: 0, behavior: "smooth" });
  }

  function resetStroke(){
    ctx.lineWidth = 2.2;
    ctx.lineCap = "round";
    ctx.strokeStyle = "#111";
  }

  function clearPad(){
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    resetStroke();
  }

  function getPos(e){
    const rect = canvas.getBoundingClientRect();
    const touch = e.touches && e.touches[0];
    const clientX = touch ? touch.clientX : e.clientX;
    const clientY = touch ? touch.clientY : e.clientY;
    return { x: clientX - rect.left, y: clientY - rect.top };
  }

  function startDraw(e){
    drawing = true;
    last = getPos(e);
  }

  function endDraw(){
    drawing = false;
    last = null;
  }

  function draw(e){
    if(!drawing) return;
    e.preventDefault();
    const p = getPos(e);
    ctx.beginPath();
    ctx.moveTo(last.x, last.y);
    ctx.lineTo(p.x, p.y);
    ctx.stroke();
    last = p;
  }

  function hasInk(){
    const pixels = ctx.getImageData(0, 0, canvas.width, canvas.height).data;
    // Look for any non-transparent pixel
    for(let i = 3; i < pixels.length; i += 4){
      if(pixels[i] !== 0) return true;
    }
    return false;
  }

  function moveNoInsideCard(){
    // float the No button inside the card so it doesn't disappear
    noBtn.classList.add("noFloat");

    const cardRect = card.getBoundingClientRect();
    const btnRect = noBtn.getBoundingClientRect();

    const padding = 18;
    const maxX = cardRect.width - btnRect.width - padding;
    const maxY = cardRect.height - btnRect.height - padding;

    const x = Math.max(padding, Math.random() * maxX);
    const y = Math.max(padding + 80, Math.random() * maxY); // keep away from top title

    noBtn.style.left = x + "px";
    noBtn.style.top  = y + "px";
  }

  // Wire up buttons (no inline onclick)
  yesBtn.addEventListener("click", () => {
    showStep(step2);
    // In case user is in a JS-blocking preview, show hint after first interaction attempt
    warn.style.display = "none";
  });

  noBtn.addEventListener("click", () => {
    moveNoInsideCard();
    warn.style.display = "none";
  });

  backBtn.addEventListener("click", () => showStep(step1));

  continueBtn.addEventListener("click", () => {
    const n = (nameInput.value || "").trim();
    cowName = n.length ? n : "MooMoo";
    showStep(step3);
    clearPad();
  });

  clearBtn.addEventListener("click", clearPad);

  confirmBtn.addEventListener("click", () => {
    if(!hasInk()){
      alert("Sign first üòå (a little scribble works)");
      return;
    }
    finalCowName.textContent = cowName;
    finalSignature.src = canvas.toDataURL("image/png");
    dateEl.textContent = "Date: " + new Date().toLocaleDateString();
    showStep(step4);
  });

  // Signature events
  canvas.addEventListener("mousedown", startDraw);
  canvas.addEventListener("mousemove", draw);
  window.addEventListener("mouseup", endDraw);

  canvas.addEventListener("touchstart", startDraw, { passive: false });
  canvas.addEventListener("touchmove", draw, { passive: false });
  canvas.addEventListener("touchend", endDraw, { passive: false });

  // Init
  resetStroke();

  // If JS is working, briefly show then hide warning on load
  // (If JS were blocked, this script wouldn't run at all.)
  warn.style.display = "block";
  setTimeout(() => { warn.style.display = "none"; }, 3500);

})();
</script>
</body>
</html>
